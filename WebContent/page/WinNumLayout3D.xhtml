<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" lang="en">
<head>
<title>号码分布</title>
<link href="/css/main.css" rel="stylesheet" type="text/css" />
<link href="/css/BrianCss.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/js/FusionCharts.js"></script>
<script type="text/javascript">
	function cancelFinish(data){
		if(data=="success"){
			alert("成功：撤单完成！");
			ownerDialog.close();
		}else{
			alert("失败：该投注记录超过了撤单时限，不能撤单。");
		}
	}
	function closewin(){
		ownerDialog.close();
	}
	var gFType="Column2D.swf";
	function typeClick(v){
		gFType = v;
		var s1 = document.getElementById("winLayoutForm:xmldata").value;
		if(s1.length==""){
			return;
		}
		var chart = new FusionCharts("/swf/"+gFType,"nudt","790","370","0","0");
		chart.setDataXML(s1);
		chart.render("winLayoutForm:flashban");
	}
	function postInfo(){
		var lotid = document.getElementById("winLayoutForm:lotid").value;
		var nums = document.getElementById("winLayoutForm:issueNum").value;
		var tps = "";
		var rPort = document.getElementsByName("identity"); 
		for(i=0; i&lt;rPort.length; i++){ 
			if(rPort[i].checked) 
				tps=rPort[i].value; 
		}
		optSubPost(lotid,nums,tps);
	}
	function finishLoad(data){
		if(data){
			alert(data);
			return;
		}else{
			var chart = new FusionCharts("/swf/"+gFType,"nudt","790","370","0","0");
			var s1 = document.getElementById("winLayoutForm:xmldata").value;
			chart.setDataXML(s1);
			chart.render("winLayoutForm:flashban");
		}
	}
	
</script>
</head>
<body style="background:#FFFFFF">
	<f:view>
		<h:form id="winLayoutForm">
			<h:inputHidden value="#{WinNumLayoutBean.xmls}" id="xmldata" />
			<h:inputHidden value="#{WinNumLayoutBean.lotteryid}" id="lotid" />
			<table class="tableclass" style="font-size:13px;width:100%;" cellpadding="0" cellspacing="0">
				<tr style="height:35px;">
					<td class="tdrightbg">位置：</td>
					<td class="tdleftbg" colspan="4">
						<input type="radio" name="identity" value="0" checked="checked" id="rad0"/><label for="rad0">全部</label><rich:spacer width="10"/>
						<input type="radio" name="identity" value="3" id="rad3"/><label for="rad3">百位</label><rich:spacer width="10"/>
						<input type="radio" name="identity" value="4" id="rad4"/><label for="rad4">十位</label><rich:spacer width="10"/>
						<input type="radio" name="identity" value="5" id="rad5"/><label for="rad5">个位</label>
						
						<a4j:commandButton ajaxSingle="true" onclick="if(!confirm('请确认：是否确定进行撤单?'))return false;" status="normalStatus" value="分  析" data="#{GameRecordBean.msg}" oncomplete="cancelFinish(data)" 
						styleClass="bntclass" action="#{GameRecordBean.cancelBet}" rendered="#{BetRecordBean.betinfo.status==0 &amp;&amp; BetRecordBean.curloginname==BetRecordBean.betinfo.loginname?'true':'false'}">
							<f:param value="#{BetRecordBean.betinfo.id}" name="id"/>
						</a4j:commandButton>
					</td>
				</tr>
				<tr style="height:35px;">
					<td class="tdrightbg">最近：</td>
					<td class="tdleftbg"><h:inputText id="issueNum" style="background:#fdfdfd;border:1px solid #aaaaaa;padding-left:5px;font-size:14px;" size="5" value="1"/> 期</td>
					<td class="tdrightbg">展示图形：</td>
					<td class="tdleftbg">
						<select id="showType" style="width:110px" onchange="typeClick(this.value)">
							<option value="Column2D.swf">柱形图2D</option>
							<option value="Column3D.swf">柱形图3D</option>
							<option value="Doughnut2D.swf">环形2D</option>
							<option value="Doughnut3D.swf">环形3D</option>
							<option value="Line.swf">折线图</option>
							<option value="Pie2D.swf">饼图</option>
						</select>
					</td>
					<td class="tdleftbg">
						<a4j:commandButton value="分 析" styleClass="bntclass" onclick="postInfo();return false;"/>
					</td>
				</tr>
				<tr>
					<td class="tdleftbg" colspan="5" style="height:375px;">
						<h:panelGroup id="flashban">
						</h:panelGroup>
					</td>
				</tr>
				<tr>
					<td colspan="5" align="center" height="40px" style="background:#e8e8e8">
						<input type="button" value="关  闭" onclick="closewin();" class="bntclass"/>
					</td>
				</tr>
			</table>
			<a4j:region>
				<a4j:jsFunction name="optSubPost" reRender="xmldata" action="#{WinNumLayoutBean.view}" data="#{WinNumLayoutBean.msg}" oncomplete="finishLoad(data);">
					<f:param name="lotid"></f:param>
					<f:param name="nums"></f:param>
					<f:param name="types"></f:param>
				</a4j:jsFunction>
			</a4j:region>
			<ui:include src="/submitStatus.xhtml" />
		</h:form>
	</f:view>
</body>
</html>
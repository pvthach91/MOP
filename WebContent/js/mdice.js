!function(){$(function($){function layeropen(e){var t=layer.open({type:1,title:!1,closeBtn:0,skin:"layui-layer-nobg",area:e.area,shadeClose:e.shadeClose,content:e.content});return t}function fftime(e){return Number(e)<10?"0"+Number(e):Number(e)}function format(e){return new Date(e.replace(/[\-\u4e00-\u9fa5]/g,"/"))}function diff(e){return e>0?{day:Math.floor(e/86400),hour:Math.floor(e%86400/3600),minute:Math.floor(e%3600/60),second:Math.floor(e%60)}:{day:0,hour:0,minute:0,second:0}}function request(param,callback,dataType){$.ajax({type:"POST",url:global_game_config.lt_ajaxurl,dataType:dataType?"json":"text",data:param,success:function(data){if(dataType&&(data=JSON.stringify(data)),data.length<=0)return alert("获取数据失败,请刷新页面"),!1;var partn=/<script.*>.*<\/script>/;return partn.test(data)?(alert("登陆超时，或者帐户在其他地方登陆，请重新登陆"),top.location.href="./",!1):"empty"==data?(alert("未到销售时间"),!1):(eval("data="+data),void(callback&&callback(data)))},error:function(){console.log("error")}})}function winnumberHTML(e){if(!e)return"";for(var t="",i=0,n=0;n<e.length;n++)t+='<i class="mdice mdice-'+e[n]+'"></i>',i+=Number(e[n]);return e.charAt(0)==e.charAt(1)&&e.charAt(1)==e.charAt(2)?t+='<i class="sign sign-baozi">豹</i><i class="sign sign-baozi">豹</i>':(t+=i>10?'<i class="sign sign-big">大</i>':'<i class="sign sign-small">小</i>',t+=i%2==1?'<i class="sign sign-odd">单</i>':'<i class="sign sign-even">双</i>'),t}function updateBalance(e){var t=$("#J-user-balance"),i=$("#J-money-tip"),n=t.text(),a=Number(n.replaceAll(",","")),o=e-a;t.text(formatMoney(e,3)),a&&Number(o.toFixed(2))&&(i.removeClass("money-tip-down"),o>0?i.text("+ "+formatMoney(o,2)):(i.text("- "+formatMoney(Math.abs(o),2)),i.addClass("money-tip-down")),i.css({top:0,right:-1*i.width()-10}),i.stop().animate({opacity:1},function(){i.stop().animate({top:50,opacity:0},2e3)}))}function renderBetHistory(){request("flag=getbetcodehistory&sid="+global_game_config.gameid,function(e){var t=e.data.reslist;if(balance=e.data.userbalance,updateBalance(balance),t&&t.length){for(var i=document.createDocumentFragment(),n=0;n<t.length;n++){var a=t[n],o=document.createElement("tr");o.innerHTML='<td class="date">'+a.issue.slice(9)+'</td><td class="state status_'+a.status+'">'+a.statusname+'</td><td class="betMoney">'+a.amount+'</td><td class="getMoney">'+formatMoney(a.bonus)+'</td><td><div class="see" sid="'+a.id+'"></div></td>',i.appendChild(o)}game_record_tableDom.innerHTML="",game_record_tableDom.appendChild(i)}})}function renderOpenHistory(){request("flag=getopencodehistory&sid="+global_game_config.gameid+"&num=10",function(e){for(var t=e.data,i=document.createDocumentFragment(),n=0;n<t.length;n++){var a=t[n];if(!a.winnumber)return;var o=document.createElement("tr");o.innerHTML='<td class="dl_issue">'+a.issue+'</td><td class="dl_number">'+winnumberHTML(a.winnumber)+"</td>",i.appendChild(o)}dl_listDom.innerHTML="",dl_listDom.appendChild(i)})}function getLastOpenCode(){function e(e){var t=e.slice(0,9),i=Number(e.slice(9))-1;if(!i)return"";for(var n=String(i),a=4-n.length,o=0;a>o;o++)n="0"+n;var s=t+n;return s}drawLet(e(curr_issue.issue))}function initScrollPanel(){$("#go_info_panel").jScrollPane({autoReinitialise:!0,hideFocus:!0,verticalGutter:0}),$(".game_record_container").jScrollPane({autoReinitialise:!0,hideFocus:!0,verticalGutter:0}),$("#game_record_info").jScrollPane({autoReinitialise:!0,hideFocus:!0,verticalGutter:0}),$("#codesList").jScrollPane({autoReinitialise:!0,hideFocus:!0,verticalGutter:0}),$("#betInfoList").jScrollPane({autoReinitialise:!0,hideFocus:!0,verticalGutter:0})}function initRequest(e){request("flag=init",function(t){if("success"!=t.status)return void(maxInitRequestTime&&setTimeout(function(){initRequest(e),maxInitRequestTime--},3e3));t=t.data,global_game_config.methods=t.k31fmethod,global_game_config.issueliststr=t.issueliststr,global_game_config.maxbetmoney=t.maxbetmoney,curr_issue=t.curissue;var i=t.lastopenissue;lt_opentimer(i.endtime,i.opentime,i.issue),e&&e()})}function lt_reset(){request("flag=getCurIssure&lotteryid="+global_game_config.gameid,function(e){"success"===e.status?(e=e.data,curr_issue=e,$record_date.html(e.issue),lt_timerHtml(e.servertime,e.endtime)):lt_reset()})}function stopOpenCodeAnimate(){$(".mdice_animate").hide(),$(".drawCode").show(),animateInterval=null}function startOpenCodeAnimate(){animateInterval||($(".drawCode").hide(),$(".mdice_animate").show())}var isLocked=!1,balance=0,betInfoIndex,lastIssue,gameNameConst={hezhi:"和值",baozi:"豹子",duizi:"对子",xiao:"小",da:"大",dan:"单",shuang:"双",erma:"两码",yima:"一码",nnn:"（任意）"};!function(){layeropen({area:["366px","286px"],shadeClose:!0,content:$("#J-tpl-modal-first-tip")}),$("[rel=modal_close]").on("click",function(){layer.closeAll()}),$("[rel=modal_close_self]").on("click",function(){layer.close(betInfoIndex)})}();var global_game_config={poscfg:[{name:"da",width:151,height:124},{left:756,name:"xiao",width:151,height:128},{top:130,name:"dan",width:153,height:75},{left:756,top:130,name:"shuang",width:153,height:75},{name:"duizi_66",left:158,top:24,width:107,height:59},{name:"duizi_55",left:158,top:82,width:107,height:59},{name:"duizi_44",left:158,top:141,width:107,height:59},{name:"duizi_33",left:645,top:24,width:107,height:59},{name:"duizi_22",left:645,top:82,width:107,height:59},{name:"duizi_11",left:645,top:141,width:107,height:59},{name:"baozi_666",left:275,top:34,width:61,height:61},{name:"baozi_555",left:334,top:34,width:61,height:61},{name:"baozi_444",left:395,top:34,width:61,height:61},{name:"baozi_333",left:454,top:34,width:61,height:61},{name:"baozi_222",left:515,top:34,width:61,height:61},{name:"baozi_111",left:575,top:34,width:61,height:61},{name:"baozi_nnn",left:275,top:100,width:365,height:100},{name:"hezhi_17",left:4,top:208,width:62,height:70},{name:"hezhi_16",left:67,top:208,width:62,height:70},{name:"hezhi_15",left:130,top:208,width:62,height:70},{name:"hezhi_14",left:193,top:208,width:62,height:70},{name:"hezhi_13",left:261,top:208,width:62,height:70},{name:"hezhi_12",left:323,top:208,width:62,height:70},{name:"hezhi_11",left:393,top:208,width:62,height:70},{name:"hezhi_10",left:458,top:208,width:62,height:70},{name:"hezhi_9",left:523,top:208,width:62,height:70},{name:"hezhi_8",left:588,top:208,width:62,height:70},{name:"hezhi_7",left:653,top:208,width:62,height:70},{name:"hezhi_6",left:718,top:208,width:62,height:70},{name:"hezhi_5",left:783,top:208,width:62,height:70},{name:"hezhi_4",left:848,top:208,width:62,height:70},{name:"erma_56",left:6,top:309,width:58,height:104},{name:"erma_46",left:66,top:309,width:58,height:104},{name:"erma_45",left:126,top:309,width:58,height:104},{name:"erma_36",left:186,top:309,width:58,height:104},{name:"erma_35",left:246,top:309,width:58,height:104},{name:"erma_34",left:306,top:309,width:58,height:104},{name:"erma_26",left:366,top:309,width:58,height:104},{name:"erma_25",left:426,top:309,width:58,height:104},{name:"erma_24",left:486,top:309,width:58,height:104},{name:"erma_23",left:546,top:309,width:58,height:104},{name:"erma_16",left:606,top:309,width:58,height:104},{name:"erma_15",left:666,top:309,width:58,height:104},{name:"erma_14",left:726,top:309,width:58,height:104},{name:"erma_13",left:786,top:309,width:58,height:104},{name:"erma_12",left:846,top:309,width:58,height:104},{name:"yima_6",left:129,top:431,width:82,height:82},{name:"yima_5",left:241,top:431,width:82,height:82},{name:"yima_4",left:357,top:431,width:82,height:82},{name:"yima_3",left:469,top:431,width:82,height:82},{name:"yima_2",left:585,top:431,width:82,height:82},{name:"yima_1",left:699,top:431,width:82,height:82}],lt_ajaxurl:"/K31fGameService.aspx",gameid:80},curr_issue=null,dl_listDom=document.querySelector(".dl_list"),game_record_tableDom=document.querySelector(".game_record_table"),$record_date=$(".record_date"),$record_time=$(".record_time"),$history_head=$(".game_head .history_head"),$mdice_history_body=$(".game_head .mdice_history_body"),$draw_lottery_head=$(".draw_lottery .draw_lottery_head"),$draw_lottery_body=$(".draw_lottery .draw_lottery_body"),$draw_lottery_closeBtn=$(".draw_lottery .draw_lottery_body .closeBtn"),$betDetailTable=$(".game_record_messageBox table"),loginnameDom=$betDetailTable.find("tr:nth-child(1) td:nth-child(2)"),statusDom=$betDetailTable.find("tr:nth-child(1) td:nth-child(4)"),sidDom=$betDetailTable.find("tr:nth-child(2) td:nth-child(2)"),betTimeDom=$betDetailTable.find("tr:nth-child(2) td:nth-child(4)"),gameNameDom=$betDetailTable.find("tr:nth-child(3) td:nth-child(2)"),issueDom=$betDetailTable.find("tr:nth-child(3) td:nth-child(4)"),betMoneyDom=$betDetailTable.find("tr:nth-child(5) td:nth-child(2)"),opencodeDom=$betDetailTable.find("tr:nth-child(5) td:nth-child(4)"),winNumDom=$betDetailTable.find("tr:nth-child(6) td:nth-child(2)"),bonusDom=$betDetailTable.find("tr:nth-child(6) td:nth-child(4)"),isTraceDom=$betDetailTable.find("tr:nth-child(7) td:nth-child(2)"),traceNumDom=$betDetailTable.find("tr:nth-child(7) td:nth-child(4)"),betDetailDom=$betDetailTable.find("#game_record_info div"),betInfoListDom=document.querySelector("#betInfoBox #betInfoList div"),cancel_btnDom=$(".game_record_messageBox .cancelBetBtn"),$chipgroup=$("#J-chipgroup-cont"),$chipgroup_others=$("#chipgroup_others"),lt_time_leave=0,template=function(e,t){var i,n,a=t;for(i in a)a.hasOwnProperty(i)&&(n=RegExp("<#="+i+"#>","g"),e=e.replace(n,a[i]));return e},formatMoney=function(e,t){var e=Number(e),t=void 0==t||0>t?2:t,i=/(-?\d+)(\d{3})/;for(e=Number.prototype.toFixed?e.toFixed(t):Math.round(e*Math.pow(10,t))/Math.pow(10,t),e=""+e;i.test(e);)e=e.replace(i,"$1,$2");return e},numToCss=function(e){return(""+Number(e).toFixed(2)).replace(".","_")};String.prototype.replaceAll=function(e,t){var i=this;return i.replace(new RegExp(e,"g"),t)};var maxInitRequestTime=3,drawLet=function(e){function t(){request("flag=getopencode&lotteryid="+global_game_config.gameid+"&issue="+e,function(e){var t=e.data.code;if(t){clearInterval(n);for(var i=$(".game_head .game_record_time .drawLet .drawCode i"),a=0;3>a;a++)i.get(a).className="mdice mdice-"+t[a];stopOpenCodeAnimate(),renderOpenHistory()}})}var i=0,n=window.setInterval(function(){i>20?(clearInterval(n),console.log("can not get the open code!!!")):(i++,t())},1500)},lt_opentimer=function(e,t,i){startOpenCodeAnimate(),$(".game_head .game_record_time .issueno").text(i.slice(9));var n=0;n=""==e||""==t?0:(format(t).getTime()-format(e).getTime())/1e3,window.setTimeout(function(){drawLet(i)},1e3*n)},lt_timerHtml=function(e,t){lt_time_leave=""==e||""==t?0:(format(t).getTime()-format(e).getTime())/1e3;var i=Math.ceil(59*Math.random()+210),n=Math.ceil(59*Math.random()+30),a=window.setInterval(function(){lt_time_leave>0&&(lt_time_leave%i==0||lt_time_leave==n)&&request("flag=getCurIssure&lotteryid="+global_game_config.gameid,function(e){e=e.data,lt_time_leave=(format(e.endtime).getTime()-format(e.servertime).getTime())/1e3}),0>=lt_time_leave&&(clearInterval(a),lt_opentimer(curr_issue.endtime,curr_issue.opentime,curr_issue.issue),lt_reset());var e=diff(lt_time_leave--);$record_time.html(""+(e.day>0?e.day+lot_lang.dec_s21+" ":"")+(fftime(e.hour)+"").substr(0,2)+" : "+(fftime(e.minute)+"").substr(0,2)+" : "+(fftime(e.second)+"").substr(0,2))},1e3)},initEventHandler=function(){function e(){var e=$(".isGo:checked"),t=0,i=e.length;$.each(e,function(){var e=Number($(this).parent().siblings(".trace_money").children(".moneyValue").text());t+=e}),t?$("#J-button-comfirm-bet-many").removeClass("btn-disabled"):$("#J-button-comfirm-bet-many").addClass("btn-disabled"),$("#J-tpl-modal-bet-many .qi").text(i),$("#J-tpl-modal-bet-many .totalMoney").text(t)}$history_head.on("click",function(){$mdice_history_body.slideDown()}),$(".mdice_history_body").on("click",".closeBtn,.close_span",function(){$mdice_history_body.slideUp()}),$draw_lottery_head.on("click",function(){$draw_lottery_body.slideDown(),renderOpenHistory()}),$(".draw_lottery_body").on("click",".closeBtn,.close_span",function(){$draw_lottery_body.slideUp()}),$chipgroup_others.sortable({helper:"clone"}),$chipgroup_others.on("click",".chip",function(){$chipgroup_others.find(".chip.chip-selected").removeClass("chip-selected"),$(this).addClass("chip-selected")}),$(".changeChips,#chipgroup_closeBtn").on("click",function(){"visible"===$chipgroup.css("visibility")?($chipgroup_others.css("left",$chipgroup.position().left),$chipgroup.css("visibility","hidden"),$chipgroup_others.show()):($chipgroup.empty().append($chipgroup_others.find(".chip").slice(-5,15).clone()),$chipgroup.find(".chip:first").trigger("click").addClass("chip-selected"),$chipgroup.css("visibility","visible"),$chipgroup_others.hide())}),$("#go_info_panel").on("click","tr",function(){var t=$(this),i=t.find(".select .isGo");t.hasClass("selected")?i.prop("checked",!1):i.prop("checked",!0),t.toggleClass("selected"),e()}),$("#go_info_panel").on("click",".add_btn",function(t){var i=parseInt($("#J-num-money").text()),n=$(this).siblings(".moneyValue");return n.text(Number(n.text())+i),e(),!1}),$("#go_info_panel").on("click",".minus_btn",function(t){var i=parseInt($("#J-num-money").text()),n=$(this).siblings(".moneyValue"),a=Number(n.text())-i;return a>0&&(n.text(a),e()),!1}),$(".game_record_table").on("click",".see",function(){var e=$(this).attr("sid");request("flag=getbetdetail&sid="+e,function(e){if("success"==e.status){var t=e.data,i=t.betinfo;loginnameDom.text(t.curloginname),statusDom.addClass("status_"+i.status),"0"!=i.status?$(".game_record_messageBox_body .cancelBetBtn").hide():$(".game_record_messageBox_body .cancelBetBtn").show(),statusDom.text(i.statusname),sidDom.text(i.id),betTimeDom.text(i.bettime),gameNameDom.text(i.lotteryname),issueDom.text(i.issue),betMoneyDom.text(i.amount),opencodeDom.html(winnumberHTML(i.winnumber)),winNumDom.text(i.wintimes),bonusDom.text(i.bonus),isTraceDom.text(1==i.source?"是":"否"),traceNumDom.text(i.traceid),betDetailDom.html(i.codes),cancel_btnDom.attr("sid",i.id),layeropen({area:["606px","506px"],shadeClose:!1,content:$(".game_record_messageBox")})}})}),$(".game_record_messageBox").on("click",".cancelBetBtn",function(){var e=$(this).attr("sid");request("flag=cancelbet&sid="+e,function(e){var t="撤单成功";"error"==e.status&&(t=e.data),showMessageBox(t),setTimeout(function(){layer.closeAll()},1500)})}),$(".viewAllDraws").on("click",function(){var e=document.querySelector("#codesList table");request("flag=getopencodehistory&sid="+global_game_config.gameid+"&num=100",function(t){for(var i=t.data,n=document.createDocumentFragment(),a=0;a<i.length;a++){var o=i[a];if(!o.winnumber)return;var s=document.createElement("tr");s.innerHTML='<td class="issueno">'+o.issue+'</td><td class="opencode">'+winnumberHTML(o.winnumber)+"</td>",s.innerHTML+='<td class="opentime">'+o.opentime+"</td>",n.appendChild(s)}e.innerHTML="",e.appendChild(n)}),layeropen({area:["606px","506px"],shadeClose:!1,content:$(".viewAllCode_modal")})})},showMessageBox=function(e){$("#messageBox p").text(e),layeropen({area:["366px","156px"],shadeClose:!0,content:$("#messageBox")})},initAnimate=function(){function e(e){this.money=Number(e),this.getMoney=function(){return this.money},this.toString=function(){return String(this.money)}}function t(e){var t=this;t.name=e.name,t.id=e.id,t.prize=e.prize,t.max=e.max,t.left=e.left,t.top=e.top,t.width=e.width,t.height=e.height,t.chips=[],this.toString=function(){return t.name+" "+t.id+" "+t.prize+" "+t.max+" "+t.left+" "+t.top+" "+t.width+" "+t.height},t.getId=function(){return this.id},t.getName=function(){return this.name},t.getPrize=function(){return this.prize},t.getMax=function(){return this.max},t.getChips=function(){return this.chips},t.addChip=function(e){var t=this;t.chips.push(e)},t.removeChip=function(e){var t=this,i=t.getChips(),n=0,a=i.length;for(n=0;a>n;n++)e==i[n]&&i.splice(n,1);t.chips=i},t.getMoney=function(){var e=this,t=e.chips,i=0,n=t.length,a=0;for(i=0;n>i;i++)a+=t[i].getMoney();return a},t.getChipsNum=function(){var e=this,t=e.getChips();return t.length},t.goBack=function(){return this.getChips().pop()}}function i(){for(var e=0,t=0;t<p.length;t++)e+=p[t].chip.getMoney();$("#J-num-money").text(formatMoney(e))}function n(){p.length?($("#cancelBtn").removeClass("btn-disabled"),$("#clearBtn").removeClass("btn-disabled"),$("#J-button-submit").removeClass("btn-disabled"),$("#J-button-bet-many").removeClass("btn-disabled")):($("#cancelBtn").addClass("btn-disabled"),$("#clearBtn").addClass("btn-disabled"),$("#J-button-submit").addClass("btn-disabled"),$("#J-button-bet-many").addClass("btn-disabled"))}function s(e,t){for(var i=0;i<p.length;i++){var n=p[i];if(n.item.toString()==e.toString()&&n.chip.toString()==t.toString()){p.splice(i,1);break}}}function l(e){if(e){var t=e.item,i=e.chip;t.removeChip(i),b(t,i),$("div[data-name="+t.name+"] .text").text(formatMoney(t.getMoney()))}}function d(){for(;;){var e=p.pop();if(!e)break;l(e)}i()}function c(e){var t=e.split("_"),i=t[0],n=t[1],a=gameNameConst[i];return"duizi"==i&&(n=n.substr(0,1)),n&&(a+=gameNameConst[n]?gameNameConst[n]:n),a}var m=$("#J-table-desktop"),h=[],u=[],p=[];!function(){var e,i=global_game_config.methods,n=global_game_config.poscfg,a={};$.each(i,function(){a[this.name]||(a[this.name]=this)}),$.each(n,function(){a[this.name]&&(e=a[this.name],h.push(new t({name:this.name,id:e.id,prize:e.prize,max:e.max,left:this.left,top:this.top,width:this.width,height:this.height})))})}(),function(){for(var e='<div data-name="<#=name#>" class="item item-<#=name#>" style="left:<#=left#>px;top:<#=top#>px;width:<#=width#>px;height:<#=height#>px;"><span class="tip"><span class="text">0.00</span><span class="arrow"></span></span></div>',t=0;t<h.length;t++)u[h[t].name]=h[t];var i,n,a,o=[];for(i in u)u.hasOwnProperty(i)&&(n=u[i],a={name:n.name,id:n.id,left:n.left,top:n.top,width:n.width,height:n.height},o.push(template(e,a)));$(o.join("")).appendTo(m)}(),m.on("mouseenter",".item",function(){var e=$(this),t=e.attr("data-name"),i=u[t],n=0;n=i.getMoney(),n>0&&(e.find(".tip").addClass("tip-show").find(".text").text(formatMoney(n)),e.addClass("item-hover"))}),m.on("mouseleave",".item",function(){var e=$(this);e.find(".tip").removeClass("tip-show"),e.removeClass("item-hover"),i()}),m.on("contextmenu",".chip",function(e){var t=$(this).parent(),n=t.attr("data-name"),a=u[n],o=a.getChips(),r=o[o.length-1];r&&(s(a,r),i()),a.removeChip(r),b(a,r),t.find(".text").text(formatMoney(a.getMoney())),e.preventDefault()}),m.on("contextmenu",function(e){e.preventDefault()});var f=$("#J-chipgroup-cont"),g=$("body"),_=function(t){var a=null;a=$chipgroup_others.is(":visible")?$chipgroup_others:f;var o=$("#J-table-desktop").find(".item-"+t.getName()),s=t.getChipsNum(),r=a.children(".chip-selected"),l=new e(r.data("money")),d=(t.addChip(l),"chip-"+numToCss(l.getMoney())),c="global-chip",m=a.find("."+d).eq(0),h=m.clone(),u=h.clone(),_=m.offset(),b=o.offset();u.addClass(d).addClass(c).removeClass("chip-selected"),h.css({left:_.left,top:_.top}),h.addClass(d).addClass(c).removeClass("chip-selected"),h.appendTo(g),h.animate({left:b.left+o.width()/2-h.width()/2,top:b.top+o.height()/2-h.height()/2-3*(s-1)},function(){h.remove(),u.appendTo(o),u.css({left:o.width()/2-u.width()/2,top:o.height()/2-u.height()/2-3*s}),o.find(".tip").css({top:-35-2*t.getChipsNum()}),o.find(".text").text(formatMoney(t.getMoney())),p.push({item:t,chip:l}),i(),n()})},b=function(e,t){var i=f.find(".chip-"+numToCss(t.getMoney()));i.size()||(i=f.find("i:first"));var a=$("#J-table-desktop").find(".item-"+e.getName()),o=a.find(".chip"),s=o.eq(o.size()-1),r=s.clone(),l="chip-selected",d="move-chip",c=a.offset(),m=i.offset();r.removeClass(l),r.addClass(d),r.appendTo(g),r.css({left:c.left+a.width()/2-r.width()/2,top:c.top+a.height()/2-r.height()/2}),s.remove(),r.animate({left:m.left,top:m.top},function(){r.remove(),n()})};m.on("click",".item",function(){var e=$(this),t=null;t=$chipgroup_others.is(":visible")?$chipgroup_others:f,n=e.attr("data-name"),r=u[n],o=r.getMoney(),a=r.getMax(),m=t.children(".chip-selected");for(var i=0,n=0;n<p.length;n++)i+=p[n].chip.getMoney();return parseFloat(m.data("money"))+i>parseFloat(balance)?($("#J-tip-text-max-money-tip").text(formatMoney(balance,3)),$("#J-tpl-modal-tip .msgTitle").text("下注金额超过余额"),void layeropen({area:["366px","156px"],shadeClose:!0,content:$("#J-tpl-modal-tip")})):parseFloat(m.data("money"))+i>global_game_config.maxbetmoney?($("#J-tip-text-max-money-tip").text(formatMoney(global_game_config.maxbetmoney)),$("#J-tpl-modal-tip .msgTitle").text("金额超限，单次投注最大可投注金额"),void layeropen({area:["366px","156px"],shadeClose:!0,content:$("#J-tpl-modal-tip")})):void(o+parseFloat(m.data("money"))>a?($("#J-tip-text-max-money-tip").text(formatMoney(a)),$("#J-tpl-modal-tip .msgTitle").text("金额超限，该玩法最大可投注金额"),layeropen({area:["366px","156px"],shadeClose:!0,content:$("#J-tpl-modal-tip")})):(e.addClass("item-hover"),_(r,m)))}),$("#cancelBtn").on("click",function(e){if(p.length){var t=p.pop();l(t),i(),e.preventDefault()}}),$("#clearBtn").on("click",function(){p.length&&d()});var y=function(){for(var e=0,t={},i=0;i<p.length;i++){var n=p[i].item,a=p[i].chip,o=a.getMoney();t[n.getName()]?t[n.getName()]+=o:t[n.getName()]=o,e+=o}var s={flag:"bet",gameid:global_game_config.gameid,trace_if:0,total_nums:1,total_money:e,betdata:t,buyitem:["{'money':"+e+", 'nums': 1, 'times': '1'}"]};return s};$("#betInfoBox .confirm_btn").on("click",function(){if(!isLocked){isLocked=!0;var e=y();if(e.issue_start=lastIssue,e.total_money)if("false"==$("#betInfoBox").data("isTrace"))request(e,function(e){var t="投注成功";"error"==e.status&&(t=e.data),showMessageBox(t),setTimeout(function(){layer.closeAll()},1500),renderBetHistory(),d(),isLocked=!1},"json");else{var t="no";$(".isStopGO input").is(":checked")&&(t="yes");var i=$(".isGo:checked"),n=(i.length,[]);$.each(i,function(){var t=$(this),i={},a=t.attr("ids"),o=t.parent().siblings(".trace_money").find(".moneyValue").text();i="{'issue':"+a+",'times': '"+o/e.total_money+"'}",n.push(i)}),e.trace_total_money=parseInt($("#J-tpl-modal-bet-many .totalMoney").text()),e.total_money=parseInt(e.total_money),e.trace_if=1,e.total_nums=1,e.trace_count_input=$("#J-tpl-modal-bet-many .qi").text(),e.trace_stop=t,e.buytrace=n,request(e,function(e){var t="投注成功";"error"==e.status&&(t=e.data),showMessageBox(t),setTimeout(function(){layer.closeAll()},1500),renderBetHistory(),d(),isLocked=!1},"json")}}}),$("#J-button-submit").on("click",function(){if(p.length){$("#betInfoBox .traceInfo").hide();var e=y();lastIssue=curr_issue.issue,$("#betInfoBox .title").text("确定加入"+lastIssue+"期");var t=e.betdata,i=document.createDocumentFragment();for(var n in t){var a=document.createElement("p");a.innerHTML="【"+c(n)+"】投注: "+t[n]+"元",i.appendChild(a)}betInfoListDom.innerHTML="",betInfoListDom.appendChild(i),$("#betInfoBox .totalMoney").text(e.total_money),$("#betInfoBox").data("isTrace","false"),betInfoIndex=layeropen({area:["606px","263px"],shadeClose:!1,content:$("#betInfoBox")})}}),$("#J-button-bet-many").on("click",function(){for(var e=0,t=0;t<p.length;t++)e+=p[t].chip.getMoney();if(e){lastIssue=curr_issue.issue;for(var i=global_game_config.issueliststr,n=document.querySelector("#go_info_panel table"),a=document.createDocumentFragment(),o=0,t=0;t<i.length;t++){var s=i[t],r=document.createElement("tr");s.issue>=curr_issue.issue&&(o++,r.innerHTML='<td class="id ">'+o+'</td><td class="select "><input type="checkbox" class="isGo" ids="'+s.issue+'"></td><td class="num ">'+s.issue+'</td><td class="trace_money "><div class="add_btn"></div>￥<span class="moneyValue">'+e+'</span>.00<div class="minus_btn"></div></td><td class="date ">'+s.opentime+"</td>",a.appendChild(r))}n.innerHTML="",n.appendChild(a),$("#J-button-comfirm-bet-many").addClass("btn-disabled"),$("#J-tpl-modal-bet-many .qi").text("0"),$("#J-tpl-modal-bet-many .totalMoney").text("0"),$("#betInfoBox").data("isTrace","true"),layeropen({area:["606px","506px"],shadeClose:!1,content:$("#J-tpl-modal-bet-many")})}}),$(document).on("click","#J-button-comfirm-bet-many:not(.btn-disabled)",function(){$("#betInfoBox .traceInfo").show();var e=$("#J-tpl-modal-bet-many .qi").text();$("#betInfoBox .title").text("确定追号"+lastIssue+"期"),$("#betInfoBox .traceInfo .qi").text(e);var t=$("#J-tpl-modal-bet-many .totalMoney").text();$("#betInfoBox .totalMoney").text(t);var i=y(),n=t/i.total_money,a=i.betdata,o=document.createDocumentFragment();for(var s in a){var r=document.createElement("p");r.innerHTML="【"+c(s)+"】投注: "+a[s]*n+"元",o.appendChild(r)}betInfoListDom.innerHTML="",betInfoListDom.appendChild(o),betInfoIndex=layeropen({area:["606px","263px"],shadeClose:!1,content:$("#betInfoBox")})}),f.on("click",".chip",function(){f.find(".chip-selected").removeClass("chip-selected"),$(this).addClass("chip-selected")}),$(document).on("click",".isStopText",function(){var e=$(this).siblings("input");e.prop("checked")?$(this).siblings("input").prop("checked",!1):$(this).siblings("input").prop("checked",!0)})},animateInterval=null;initEventHandler(),initRequest(function(){lt_reset(),getLastOpenCode(),renderBetHistory(),setInterval(function(){renderBetHistory()},2e3),initScrollPanel(),initAnimate()})}($))}();